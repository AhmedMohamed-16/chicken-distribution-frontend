<div class="container mx-auto p-6">
  @if (loading()) {
  <div class="flex justify-center py-12">
    <div class="spinner"></div>
  </div>
  } @else if (user()) {
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <div>
        <h1 class="text-3xl font-bold">{{ user()!.full_name }}</h1>
        <p class="text-gray-600">@{{ user()!.username }}</p>
      </div>
    </div>

    <!-- Status Badge -->
    <div class="mb-6">
      <span [class]="user()!.is_active ? 'badge badge-success' : 'badge badge-error'">
        {{ user()!.is_active ? 'نشط' : 'غير نشط' }}
      </span>
    </div>

    <!-- User Information Card -->
    <div class="card mb-6">
      <h2 class="text-xl font-semibold mb-4">معلومات المستخدم</h2>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="text-sm text-gray-600">اسم المستخدم</label>
          <p class="font-medium">{{ user()!.username }}</p>
        </div>
        <div>
          <label class="text-sm text-gray-600">الاسم الكامل</label>
          <p class="font-medium">{{ user()!.full_name }}</p>
        </div>
        <div>
          <label class="text-sm text-gray-600">الايميل</label>
          <p class="font-medium">{{ user()!.email || '-' }}</p>
        </div>
        <div>
          <label class="text-sm text-gray-600">التلفون</label>
          <p class="font-medium">{{ formatNumber(user()!.phone) || '-' }}</p>
        </div>
        <div>
          <label class="text-sm text-gray-600">وقت الانشاء</label>
          <p class="font-medium">{{ formatDateTime(user()!.created_at )}}</p>
        </div>
        <div>
          <label class="text-sm text-gray-600">الحاله</label>
          <p class="font-medium">
            {{ user()!.is_active ? 'نشط' : 'غير نشط' }}
          </p>
        </div>
      </div>
    </div>

    <!-- Permissions Card -->
    <div class="card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold">
          الصلاحيات ({{ formatNumber(user()!.permissions?.length) || 0 }})
        </h2>

      </div>

      @if (user()!.permissions && user()!.permissions!.length > 0) {
      <div class="space-y-4">
        @for (category of getPermissionsByCategory(); track category.name) {
        <div>
          <h3 class="font-semibold text-gray-700 mb-2">
            {{ category.name }}
          </h3>
          <div class="flex flex-wrap gap-2">
            @for (permission of category.permissions; track permission.id) {
            <span class="badge badge-blue">
              {{ permission.name }}
            </span>
            }
          </div>
        </div>
        }
      </div>
      } @else {
      <div class="text-center py-8 text-gray-500">
        <p>لايوجد صلاحيات تم اضافتها لهذا المستخدم</p>
      </div>
      }
    </div>
  </div>
  } @else {
  <div class="text-center py-12">
    <p class="text-xl text-gray-600">المستخدم غير موجود</p>
    <button routerLink="/master-data/users" class="btn btn-primary mt-4">
      العوده للمستخدمين
    </button>
  </div>
  }
</div>
